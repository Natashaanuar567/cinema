<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RVC Payment</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@300;600&display=swap"
    rel="stylesheet">
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  <style>
    /* General Styles */
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      color: #000000;
      background-color: #1a1a1a;
      overflow-x: hidden;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    h1,
    h2,
    h3 {
      font-weight: 600;
    }

    button {
      cursor: pointer;
    }

    /* Hero Section */
    .hero-section {
      background: linear-gradient(45deg, #db0795, #a30606);
      color: white;
      padding: 50px 20px;
      text-align: center;
    }

    .hero-content {
      max-width: 800px;
      margin: 0 auto;
    }

    .hero-content h1 span {
      color: #ffcccb;
    }

    .hero-content p {
      font-size: 18px;
      margin-top: 10px;
    }

    /* Navigation Bar */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #2a2a2a;
      padding: 15px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .nav-links {
      list-style: none;
      display: flex;
      gap: 20px;
      margin: 0;
      padding: 0;
    }

    .nav-links li a {
      color: #ffffff;
      font-size: 16px;
      padding: 8px 12px;
      border-radius: 5px;
      transition: background 0.3s;
    }

    .nav-links li a:hover {
      background: #7b0435;
    }

    .logo {
      display: flex;
      align-items: center;
    }

    .logo img {
      width: 50px;
      height: 50px;
      margin-right: 10px;
      border-radius: 50%;
    }

    .logo h1 {
      font-size: 24px;
      text-transform: uppercase;
      margin: 0;
    }

    .logo h1 span {
      color: #db0795;
    }

    .btn-login {
      font-weight: bold;
      font-size: 15px;
      background: #db0795;
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      display: flex;
      align-items: center;
      transition: background 0.3s;
    }

    .btn-login img {
      height: 20px;
      margin-right: 10px;
    }

    .btn-login:hover {
      background: #a30606;
    }

    /* Main Container */
    .container {
      max-width: 750px;
      margin: 20px auto;
      background-color: rgb(255, 197, 236);
      padding: 40px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      position: relative;
      z-index: 1;
    }

    /* Payment Details */
    .payment-details {
      margin: 30px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    .payment-details h3 {
      color: rgb(60, 60, 60);
      font-size: 1.5em;
      margin: 10px 0;
    }

    /* Form Elements */
    .payment-form {
      margin-top: 30px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-size: 1.2em;
      color: #E63946;
    }

    input,
    select {
      width: 100%;
      padding: 15px;
      margin-top: 8px;
      font-size: 1.1em;
      border-radius: 8px;
      border: 1px solid #F1FAEE;
      background-color: #2B2B2B;
      color: #F1FAEE;
      box-sizing: border-box;
    }

    input:focus,
    select:focus {
      border-color: #E63946;
      outline: none;
      transform: scale(1.02);
    }

    .button {
      background-color: #E63946;
      color: white;
      padding: 18px;
      width: 100%;
      margin-top: 30px;
      border: none;
      border-radius: 8px;
      font-size: 1.4em;
      text-transform: uppercase;
      transition: all 0.3s ease;
    }

    .button:hover {
      background-color: #F25F5C;
      transform: scale(1.05);
    }

    /* Success Message and QR Code */
    .success-message {
      background-color: #457B9D;
      color: white;
      padding: 20px;
      margin-top: 20px;
      border-radius: 8px;
      text-align: center;
      font-size: 1.2em;
      display: none;
    }

    #qrCodeContainer {
      margin: 30px auto;
      text-align: center;
      display: none;
      width: 100%;
      padding: 20px 0;
    }

    /* Add specific styling for the QR code div */
    #qrcode {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0 auto;
    }


    /* Style for the QR code image */
    #qrcode img {
      display: block;
      margin: 0 auto;
    }

    .hidden {
      display: none;
    }

    /* Footer */
    .footer {
      background-color: #61083a;
      color: white;
      padding: 30px 20px;
      text-align: center;
      margin-top: 50px;
    }

    .footer h3 {
      color: #db0795;
    }

    .social-links {
      margin: 20px 0;
    }

    .social-links a {
      margin: 0 10px;
    }

    .social-links img {
      width: 30px;
      transition: transform 0.3s;
    }

    .social-links img:hover {
      transform: scale(1.2);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .navbar {
        flex-direction: column;
      }

      .nav-links {
        flex-direction: column;
        gap: 10px;
      }

      .container {
        margin: 20px;
        padding: 20px;
      }
    }

    input:invalid,
    select:invalid {
      border-color: #ff0000;
    }

    .invalid {
      border-color: #ff0000;
    }

    #successMessage,
    #qrCodeContainer {
      display: none;
    }

    #successMessage.show,
    #qrCodeContainer.show {
      display: block;
    }
  </style>
</head>

<body>
  <header class="hero-section">
    <nav class="navbar">
      <div class="logo">
        <img src="logo.jpeg" alt="RedVibe Cinema Logo">
        <h1>Red<span>Vibe</span>Cinema</h1>
      </div>
      <ul class="nav-links">
        <li><a href="index.html">HOME</a></li>
        <li><a href="movie.html">MOVIE</a></li>
        <li><a href="food.html">FOOD</a></li>
        <li><a href="aboutus.html">ABOUT US</a></li>
      </ul>
      <a href="login.html">
        <button class="btn-login">
          <img src="user.png" alt="User Icon">LOGIN
        </button>
      </a>
    </nav>
    <div class="hero-content">
      <h1>Welcome to <span>RedVibe Cinema</span></h1>
      <p>Experience movies like never before, where entertainment meets luxury in every showtime.</p>
    </div>
  </header>

  <div class="container">
    <h2>RedVibe Cinema Payment</h2>

    <div class="payment-details">
      <h3>Selected Movie: <span id="selectedMovie">No movie selected</span></h3>
      <h3>Movie Price: RM<span id="moviePrice">0.00</span></h3>
      <h3>Selected Food: <span id="selectedFood">No food selected</span></h3>
      <h3>Food Price: RM<span id="foodPrice">0.00</span></h3>
      <h3 class="total">Total Price: RM<span id="totalPrice">0.00</span></h3>
    </div>

    <form class="payment-form" onsubmit="return storeData();">
      <label for="paymentMethod">Select Payment Method:</label>
      <select id="paymentMethod" name="paymentMethod" onchange="togglePaymentFields();">
        <option value="tng">TNG E-Wallet</option>
        <option value="bankTransfer">Bank Transfer</option>
        <option value="creditCard">Credit Card</option>
      </select>

      <!-- Update the form inputs to include name attributes -->
      <div id="tngFields" class="hidden">
        <label for="tngUsername">TNG Username</label>
        <input type="text" id="tngUsername" name="tngUsername" placeholder="Enter TNG Username" required>
        <label for="tngPin">TNG PIN</label>
        <input type="password" id="tngPin" name="tngPin" placeholder="Enter TNG PIN" required>
      </div>

      <div id="bankTransferFields" class="hidden">
        <label for="selectBank">Select Your Bank</label>
        <select id="selectBank" name="selectBank">
          <option value="maybank">Maybank</option>
          <option value="bankIslam">Bank Islam</option>
          <option value="rhb">RHB Bank</option>
          <option value="bankMuamalat">Bank Muamalat</option>
          <option value="cimb">CIMB Bank</option>
          <option value="hongLeong">Hong Leong Bank</option>
        </select>
        <label for="username">Username</label>
        <input type="text" id="username" name="username" placeholder="Enter Username" required>
        <label for="password">Password</label>
        <input type="password" id="password" name="password" placeholder="Enter Password" required>
      </div>

      <div id="creditCardFields" class="hidden">
        <label for="cardNumber">Card Number</label>
        <input type="text" id="cardNumber" name="cardNumber" placeholder="Enter Card Number" maxlength="16" required>
        <label for="expirationDate">Expiration Date</label>
        <input type="month" id="expirationDate" name="expirationDate" required>
        <label for="cvv">CVV</label>
        <input type="text" id="cvv" name="cvv" placeholder="Enter CVV" maxlength="3" required>
      </div>

      <button type="submit" class="button">Proceed to Payment</button>
    </form>

    <div class="success-message hidden" id="successMessage">
      Payment Successful! Please scan the QR code to enter the cinema.
    </div>

    <div id="qrCodeContainer" class="hidden">
      <div id="qrcode"></div>
    </div>

    <button class="button" onclick="goHome()">Go Back to Home</button>
  </div>

  <footer class="footer">
    <h3>Contact Us</h3>
    <p>Email: support@redvibe.com | Phone: +123 456 7890</p>
    <div class="social-links">
      <a href="#"><img src="facebook.png" alt="Facebook"></a>
      <a href="#"><img src="twitter.png" alt="Twitter"></a>
      <a href="#"><img src="ig.png" alt="Instagram"></a>
    </div>
    <p>Â© 2025 RedVibe Cinema. All Rights Reserved.</p>
  </footer>

  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Get the movie selection data
      const movieSelectionJSON = sessionStorage.getItem('movieSelection');
      let selectedMovie = 'No movie selected';
      let moviePrice = 0;

      if (movieSelectionJSON) {
        try {
          const movieSelection = JSON.parse(movieSelectionJSON);
          selectedMovie = `${movieSelection.movieTitle} (${movieSelection.showtime}) - Seats: ${movieSelection.seats.join(', ')}`;
          moviePrice = movieSelection.totalPrice;
        } catch (e) {
          console.error('Error parsing movie selection:', e);
        }
      }

      // Display movie details
      document.getElementById('selectedMovie').textContent = selectedMovie;
      document.getElementById('moviePrice').textContent = moviePrice.toFixed(2);

      // Display food details (if any)
      const selectedFood = sessionStorage.getItem('selectedFood') || 'No food selected';
      const foodPrice = parseFloat(sessionStorage.getItem('foodPrice')) || 0;
      document.getElementById('selectedFood').textContent = selectedFood;
      document.getElementById('foodPrice').textContent = foodPrice.toFixed(2);

      // Calculate and display total
      const totalPrice = (moviePrice + foodPrice).toFixed(2);
      document.getElementById('totalPrice').textContent = totalPrice;

      // Show initial payment fields
      togglePaymentFields();
    });

    function togglePaymentFields() {
      const paymentMethod = document.getElementById('paymentMethod').value;
      const allFields = ['tngFields', 'bankTransferFields', 'creditCardFields'];

      // Hide all fields and remove required attribute
      allFields.forEach(fieldId => {
        const element = document.getElementById(fieldId);
        element.classList.add('hidden');
        element.querySelectorAll('input, select').forEach(input => {
          input.required = false;
        });
      });

      // Show selected payment fields and add required attribute
      const selectedFields = document.getElementById(paymentMethod + 'Fields');
      if (selectedFields) {
        selectedFields.classList.remove('hidden');
        selectedFields.querySelectorAll('input, select').forEach(input => {
          input.required = true;
        });
      }
    }

    function storeData() {
      // Prevent the default form submission
      event.preventDefault();

      const paymentMethod = document.getElementById('paymentMethod').value;
      let isValid = true;
      let activeFields;

      // Check which payment fields are active and validate them
      if (paymentMethod === 'tng') {
        activeFields = document.getElementById('tngFields');
      } else if (paymentMethod === 'bankTransfer') {
        activeFields = document.getElementById('bankTransferFields');
      } else if (paymentMethod === 'creditCard') {
        activeFields = document.getElementById('creditCardFields');
      }

      // Remove hidden class from active fields to make them focusable
      if (activeFields) {
        activeFields.classList.remove('hidden');
        const inputs = activeFields.querySelectorAll('input, select');
        inputs.forEach(input => {
          if (input.required && !input.value.trim()) {
            isValid = false;
            input.classList.add('invalid');
          } else {
            input.classList.remove('invalid');
          }
        });
      }

      if (!isValid) {
        alert('Please fill in all required fields');
        return false;
      }

      // If validation passes, show success message and generate QR code
      document.getElementById('successMessage').style.display = 'block';

      // Clear any existing QR code
      document.getElementById('qrcode').innerHTML = '';

      // Generate new QR code
      const qrContent = {
        movie: document.getElementById('selectedMovie').textContent,
        food: document.getElementById('selectedFood').textContent,
        total: document.getElementById('totalPrice').textContent,
        paymentMethod: paymentMethod,
        timestamp: new Date().toISOString()
      };

      new QRCode(document.getElementById("qrcode"), {
        text: JSON.stringify(qrContent),
        width: 128,
        height: 128
      });

      // Show QR code container
      document.getElementById('qrCodeContainer').style.display = 'block';

      // Clear session storage after successful payment
      setTimeout(() => {
        sessionStorage.clear();
      }, 2000);

      return false;
    }

    // Update form submission
    document.querySelector('.payment-form').addEventListener('submit', storeData);

    function generateQRCode() {
      const qrContent = {
        movie: document.getElementById('selectedMovie').textContent,
        food: document.getElementById('selectedFood').textContent,
        total: document.getElementById('totalPrice').textContent,
        timestamp: new Date().toISOString()
      };

      new QRCode(document.getElementById("qrcode"), {
        text: JSON.stringify(qrContent),
        width: 128,
        height: 128
      });
      document.getElementById('qrCodeContainer').classList.remove('hidden');
    }

    function goHome() {
      window.location.href = "index.html";
    }
  </script>
</body>

</html>